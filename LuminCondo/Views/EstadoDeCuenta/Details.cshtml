@model IEnumerable<Infraestructure.Models.GestionAsignacionPlanes>

@{
    ViewBag.Title = "Details";
}
@{
    var historialDePago = new List<Infraestructure.Models.GestionAsignacionPlanes>();
    var deudasPendientes = new List<Infraestructure.Models.GestionAsignacionPlanes>();

    foreach (var item in Model.ToList())
    {
        if (item.estadoPago == true)
        {
            historialDePago.Add(item);
        }
        else
        {
            deudasPendientes.Add(item);
        }
    }
}
<h1 class="text-center">Estado de Cuenta de la Residencia @Html.DisplayFor(model => model.FirstOrDefault().IDResidencia) de @Html.DisplayFor(model => model.FirstOrDefault().GestionResidencias.Usuarios.nombre)</h1>

<h2 class="text-center"><i class="fa-solid fa-clock-rotate-left"></i> Historial de Pagos</h2>

<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.GestionPlanCobros.descripcion)
        </th>
        <th>
            Monto Pagado
        </th>
        <th>
            @Html.DisplayNameFor(model => model.fechaAsignacion)
        </th>
        <th></th>
    </tr>

    @foreach (var item in historialDePago)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.GestionPlanCobros.descripcion)
            </td>
            <td>
                @{
                    decimal total = 0;
                }
                @foreach (var c in item.GestionPlanCobros.GestionRubrosCobros)
                {

                    total += c.monto;
                }
                <i class="fa-solid fa-colon-sign"></i>@total

            </td>
            <td>
                @Html.DisplayFor(modelItem => item.fechaAsignacion)
            </td>
        </tr>
    }

</table>

<h2 class="text-center"><i class="fa-solid fa-money-check-dollar"></i> Deudas Pendientes</h2>

<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.GestionPlanCobros.descripcion)
        </th>
        <th>
            Monto a pagar
        </th>
        <th>
            @Html.DisplayNameFor(model => model.fechaAsignacion)
        </th>
        <th></th>
    </tr>

    @foreach (var item in deudasPendientes)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.GestionPlanCobros.descripcion)
            </td>
            <td>
                @{
                    decimal total = 0;
                }
                @foreach (var c in item.GestionPlanCobros.GestionRubrosCobros)
                {

                    total += c.monto;
                }
                <i class="fa-solid fa-colon-sign"></i>@total

            </td>
            <td>
                @Html.DisplayFor(modelItem => item.fechaAsignacion)
            </td>
            <td>
                <div class="text-center">
                    <a href="@Url.Action("Details","EstadoDeCuenta", new { id = item.IDResidencia })" class="btn btn-primary">
                        <i class="fa-solid fa-cart-shopping"></i> Pagar
                    </a>
                </div>
            </td>
        </tr>
        
    }

</table>
